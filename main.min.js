!function(){"use strict";function t(){}t.prototype={preload:function(){this.load.image("preloader","assets/preloader.gif")},create:function(){this.game.input.maxPointers=1,this.game.device.desktop?this.game.scale.pageAlignHorizontally=!0:(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.minWidth=480,this.game.scale.minHeight=260,this.game.scale.maxWidth=640,this.game.scale.maxHeight=480,this.game.scale.forceOrientation(!0),this.game.scale.pageAlignHorizontally=!0),this.game.state.start("preloader")}},window.tapmatch=window.tapmatch||{},window.tapmatch.Boot=t}(),function(){"use strict";function t(t,e,i,s){Phaser.Sprite.call(this,t,e,i),this.color=s,this.back=t.make.sprite(0,0,"empty"),this.front=t.make.sprite(0,0,s),this.anchor.set(.5),this.front.anchor.set(.5),this.back.anchor.set(.5),this.addChild(this.back),this.addChild(this.front),this.showBack()}t.prototype=Object.create(Phaser.Sprite.prototype),t.prototype.constructor=t,t.prototype.showFront=function(){this.front.visible||(this.front.visible=!0,this.back.visible=!1,this.front.scale.x=0,this.front.scale.y=0,this.tween=this.game.add.tween(this.front.scale).to({x:1.25,y:1.25},120,Phaser.Easing.Quadratic.InOut).to({x:1,y:1},250,Phaser.Easing.Quadratic.Out),this.tween.start())},t.prototype.showBack=function(){this.front.visible=!1,this.back.visible=!0},t.prototype.flip=function(){this.back.visible=!this.back.visible,this.front.visible=!this.front.visible},t.prototype.kill=function(){var t=this;this.front.scale.set(1),this.back.visible=!1,this.game.add.tween(this.front.scale).to({x:1.52,y:1.52},500,Phaser.Easing.Quadratic.Out,!0),this.game.add.tween(this.front).to({alpha:0},500,null,!0).onComplete.add(function(){Phaser.Sprite.prototype.kill.apply(t,arguments)})},t.prototype.debug=function(){this.showFront()},window.tapmatch=window.tapmatch||{},window.tapmatch.Card=t}(),function(){"use strict";function t(){}t.prototype={create:function(){this.level=0,this.columns=1,this.rows=1,this.selected=[],this.completed=[],this.cards=this.add.group(),this.life=10,this.maxLife=10,this.lifeBg=this.add.sprite(0,0,"life-bg"),this.lifePane=this.add.sprite(0,0,"life-pane"),this.gameover=this.add.sprite(0,0,"gameover"),this.gameover.visible=!1,this.gameover.anchor.set(.5),this.levelcomplete=this.add.sprite(0,0,"level-complete"),this.levelcomplete.visible=!1,this.levelcomplete.anchor.set(.5),this.levelcomplete.inputEnabled=!0,this.levelcomplete.events.onInputDown.add(this.initLevel,this),this.btnRetry=this.add.sprite(0,0,"btn-retry"),this.btnRetry.visible=!1,this.btnRetry.anchor.set(.5),this.btnRetry.inputEnabled=!0,this.btnRetry.events.onInputDown.add(this.restartGame,this),this.initLevel()},initLevel:function(){this.completed=[],this.selected=[],this.mapping=["orange","violet","blue","red","yellow","green"],this.level++,this.level<10&&(this.level%2?this.columns++:this.rows++),this.rows*this.columns%2&&this.rows++;var t=this,e=this.columns||2,i=this.rows||2;this.cards.removeAll();var s=this.generateMatrix(e,i,this.mapping),a=64,h=15,n=a+h,o=n*e,l=n*i;o-=h,l-=h;var r=1,c={width:this.game.width,height:this.game.height-this.lifeBg.height},d=c.width<o,p=c.height<l;if(d||p){var m=c.width/(o+2*h),u=c.height/(l+2*h);o-c.width>l-c.height?(console.log("wider"),r=m):(console.log("taller"),r=u),o*=r,l*=r,this.cards.scale.set(r)}this.cards.x=.5*c.width-.5*o,this.cards.y=.5*c.height-.5*l,this.cards.y+=this.lifeBg.height;for(var f=0,g=0;i>g;g++)for(var w=0;e>w;w++){var v=s[f],b=this.mapping[v],y=new window.tapmatch.Card(t,w*n+.5*a,g*n+.5*a,b);y.inputEnabled=!0,y.events.onInputDown.add(this.onCardTouch,this),this.add.tween(y.scale).from({x:0,y:0},450,Phaser.Easing.Exponential.Out,!0,50*(w+g)),this.cards.addChild(y),f++}this.gameover.visible=this.levelcomplete.visible=this.btnRetry.visible=!1},generateMatrix:function(t,e,i){for(var s=[],a=0;s.length<t*e;){var h=a;s.push(h),s.push(h),a++,a>=i.length&&(a=0)}return Phaser.ArrayUtils.shuffle(s),s},onCardTouch:function(t){var e=this;t.showFront(),-1===this.selected.indexOf(t)&&this.selected.push(t),2===this.selected.length&&(this.selected[0].color===this.selected[1].color?(this.selected.forEach(function(t){t.kill(),e.completed.push(t)}),this.selected=[],this.increaseLife(),this.checkResult()):this.reduceLife()),this.selected.length>2&&(this.selected.pop(),this.selected.forEach(function(t){t.showBack()}),this.selected=[t])},reduceLife:function(){return this.life--,this.life=Math.max(0,this.life),this.add.tween(this.lifePane.scale).to({x:this.life/this.maxLife},500,Phaser.Easing.Quadratic.Out,!0),this.life?void 0:this.showGameOver()},increaseLife:function(){this.life++,this.life=Math.min(this.maxLife,this.life),this.add.tween(this.lifePane.scale).to({x:this.life/this.maxLife},500,Phaser.Easing.Quadratic.Out,!0)},checkResult:function(){var t=this.completed.length===this.cards.children.length;t&&this.showLevelComplete()},showLevelComplete:function(){var t=this.levelcomplete;t.x=.5*this.world.width,t.y=.5*this.world.height,t.alpha=0,t.scale.set(10),this.add.tween(t.scale).to({x:1,y:1},1e3,Phaser.Easing.Bounce.Out,!0,1e3),this.add.tween(t).to({alpha:1},500,Phaser.Easing.Bounce.Out,!0,1e3),t.visible=!0},restartGame:function(){this.life=this.maxLife,this.level=0,this.rows=1,this.columns=1,this.initLevel()},showGameOver:function(){var t=this.gameover,e=this.btnRetry;t.x=e.x=.5*this.world.width,t.y=e.y=150,e.y+=100,t.alpha=0,t.scale.set(10),this.add.tween(t.scale).to({x:1,y:1},1e3,Phaser.Easing.Bounce.Out,!0,1e3),this.add.tween(t).to({alpha:1},500,Phaser.Easing.Bounce.Out,!0,1e3),this.add.tween(e).from({y:e.y+200,alpha:0},1e3,Phaser.Easing.Cubic.Out,!0,1250),t.visible=!0,e.visible=!0},onInputDown:function(){}},window.tapmatch=window.tapmatch||{},window.tapmatch.Game=t}(),window.addEventListener("load",function(){"use strict";var t=window.tapmatch,e=new Phaser.Game(320,480,Phaser.AUTO,"tapmatch-game");e.state.add("boot",t.Boot),e.state.add("preloader",t.Preloader),e.state.add("menu",t.Menu),e.state.add("game",t.Game),e.state.start("boot")},!1),function(){"use strict";function t(){}t.prototype={create:function(){var t=this.add.text(.5*this.game.width,.5*this.game.height,"MENU",{font:"42px Arial",fill:"#ffffff",align:"center"});t.anchor.set(.5),this.input.onDown.add(this.onDown,this)},update:function(){},onDown:function(){this.game.state.start("game")}},window.tapmatch=window.tapmatch||{},window.tapmatch.Menu=t}(),function(){"use strict";function t(){this.asset=null,this.ready=!1}t.prototype={preload:function(){this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.setPreloadSprite(this.asset),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.loadResources()},loadResources:function(){var t=[["empty","empty.png"],["orange","orange.png"],["violet","violet.png"],["blue","blue.png"],["red","red.png"],["yellow","yellow.png"],["green","green.png"],["gameover","gameover.png"],["level-complete","level-complete.png"],["btn-retry","btn-retry.png"],["life-pane","life-pane.png"],["life-bg","life-bg.png"]],e=this;t.forEach(function(t){var i=t[0],s="assets/"+t[1];e.load.image(i,s)})},create:function(){},update:function(){this.ready&&this.game.state.start("game")},onLoadComplete:function(){this.ready=!0}},window.tapmatch=window.tapmatch||{},window.tapmatch.Preloader=t}();